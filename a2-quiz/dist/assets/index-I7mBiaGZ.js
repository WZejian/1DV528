(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function c(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();const k="https://courselab.lnu.se/quiz/question/1",h=document.getElementById("entry-box"),a=document.getElementById("quiz-box"),u=document.getElementById("score-box"),f=document.getElementById("nickname-input"),B=document.getElementById("questions"),l=document.getElementById("choices-box"),m=document.getElementById("answer-input-box"),p=document.getElementById("time-left"),y=document.getElementById("reminder"),o={questionType:"",timeProcesser:null,timeLimit:10,startTime:null,username:"",highScores:[],nextQuestionURL:"",currentRadioIndex:0};function T(e){e.preventDefault(),o.username=f.value.trim(),o.username?L():alert("Empty username!")}function x(e){e.preventDefault(),clearInterval(o.timeProcesser),a.style.display="none",u.style.display="none",h.style.display="block",f.focus()}async function I(e){e.preventDefault();let t=null;if(o.questionType==="choices"){const s=l.querySelector('input[type="radio"]:checked');t=s?s.value:""}else t=m.value.trim();t?await v(o.nextQuestionURL,t):alert("Invalid answer")}function w(e){e.preventDefault(),C()}async function L(){h.style.display="none",a.style.display="block";const e=await fetch(k);if(e.ok){const t=await e.json();g(t),o.startTime=Date.now()}}function S(){clearInterval(o.timeProcesser);let e=o.timeLimit;p.innerText=`Time left:  ${e}  seconds`,o.timeProcesser=setInterval(function(){e--,e>=0?p.innerText=`Time left: ${e} seconds`:(clearInterval(o.timeProcesser),y.innerHTML="Time has run out! Game Over. Apologies!",a.style.display="none",u.style.display="block")},1e3)}function g(e){if(B.innerText=e.question,!e.alternatives)o.questionType="fill-in-the-blank",l.style.display="none",m.style.display="block",m.focus();else{o.questionType="choices",o.currentRadioIndex=-1,l.innerHTML="";for(const[t,s]of Object.entries(e.alternatives)){const c=`<label><input type="radio" name="choices-box" value="${t}">${s}</label>`;l.insertAdjacentHTML("beforeend",c)}l.style.display="block",m.style.display="none"}o.nextQuestionURL=e.nextURL,S()}async function v(e,t){const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answer:t})},c=await fetch(e,s),n=await c.json();if(c.ok)if(n.nextURL)E(n.nextURL);else{const i=(Date.now()-o.startTime)/1e3;clearInterval(o.timeProcesser),q(o.username,i),y.innerHTML=`Grattis! ${o.username}, your time: ${i.toFixed(1)} seconds!`,a.style.display="none",u.style.display="block"}else clearInterval(o.timeProcesser),y.innerHTML="Not correct answer, Game Over, Apologies!",a.style.display="none",u.style.display="block"}async function E(e){const t=await fetch(e);if(t.ok){const s=await t.json();g(s)}}function q(e,t){const s={username:e,durationTime:t};let c=JSON.parse(localStorage.getItem("highScores"));c=c||[];const n=c.concat(s);n.sort((d,b)=>d.durationTime-b.durationTime);const i=n.slice(0,5);localStorage.setItem("highScores",JSON.stringify(i)),o.highScores=i}function C(){let e="<h2>Top 5 high scores</h2><table><tr><th>Rank</th><th>Name</th><th>Time</th></tr>";o.highScores.forEach((t,s)=>{const c=`${s+1}`;e+=`<tr><td>${c}</td><td>${t.username}</td><td>${t.durationTime.toFixed(1)} s</td></tr>`}),e+="</table>",y.innerHTML=e,u.style.display="block"}const r={restartButtonClick:x,startButtonClick:T,submitButtonClick:I,highScoresLinkClick:w,identifiers:o,radioButtonField:l,quizBox:a,scoreBox:u,usernameInputField:f},O=document.getElementById("start-button"),P=document.getElementById("restart-button"),R=document.getElementById("answer-submit-button"),F=document.getElementById("highscores-link");O.addEventListener("click",r.startButtonClick);P.addEventListener("click",r.restartButtonClick);R.addEventListener("click",r.submitButtonClick);F.addEventListener("click",r.highScoresLinkClick);r.quizBox.style.display="none";r.scoreBox.style.display="none";r.usernameInputField.focus();document.addEventListener("keydown",e=>{const t=e.key;let s=r.identifiers.currentRadioIndex;if(r.identifiers.questionType==="choices"){const n=r.radioButtonField.querySelectorAll('input[type="radio"]');let i=!1;t==="ArrowUp"||t==="ArrowLeft"?(s=(s-1+n.length)%n.length,i=!0):(t==="ArrowDown"||t==="ArrowRight")&&(s=(s+1)%n.length,i=!0),i&&(n[s].focus(),n[s].checked=!0)}t==="Enter"&&(r.scoreBox.style.display==="block"?r.restartButtonClick(e):r.quizBox.style.display==="none"?r.startButtonClick(e):r.submitButtonClick(e))});
