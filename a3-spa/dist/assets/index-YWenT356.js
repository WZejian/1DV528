(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}})();class b{constructor(e,t,i,s,n){this.windowNum=e,this.app=t,this.zIndex=i,this.stateX=s,this.stateY=n}generateWindow(){console.log("app: "+this.app);const e=document.createElement("div");e.setAttribute("id","window"+this.windowNum),e.setAttribute("class","window");const t=document.createElement("div");t.innerHTML=this.option(this.app),e.appendChild(t);const i=document.createElement("div");i.setAttribute("id","window"+this.windowNum+"header"),i.setAttribute("class","header"),e.appendChild(i);const s=document.createElement("img");return s.setAttribute("id","close"+this.windowNum),s.setAttribute("src","/img/close.png"),i.appendChild(s),e.insertAdjacentHTML("beforeend",this.mainBlock(this.app)),e.style.top=this.stateX+"px",e.style.left=this.stateY+"px",e.style.zIndex=this.zIndex,e}option(e){switch(e){case"memo":return`
        <span id="timer${this.windowNum}"></span>
        <ul id = "grid${this.windowNum}" class="custom-options">
          <li class="custom-option">
              <input type="radio" id="option1" name="options" value="16" checked>
              <label for="option1">4x4</label>
          </li>
          <li class="custom-option">
              <input type="radio" id="option2" name="options" value="4">
              <label for="option2">2x2</label>
          </li>
          <li class="custom-option">
              <input type="radio" id="option3" name="options" value="8">
              <label for="option3">2x4</label>
          </li>
        </ul>`;case"chat":return`
          </div>
            <p id="connectionState${this.windowNum}" class="connectionState"></p>
          </div>
          <div class="username"> 
            <input autocomplete="off" class="username-input" id="username${this.windowNum}" type="text" placeholder="Enter username" style="width: 120px;">
          </div>`;case"slider":return` 
              <div id="circleBox${this.windowNum}" class="circlebox">
                <ol class="circle"></ol>
              </div>`;default:return""}}mainBlock(e){switch(e){case"memo":return`
              <div id="cards${this.windowNum}" class="cards"></div>
              <div id="userMessage${this.windowNum}"></div>`;case"chat":return`
              <div id="chat${this.windowNum}" class="chatDiv">
                <label>Chat Area</label>    
                <textarea id="chatArea${this.windowNum}" class="chatArea"></textarea>
                <div id="inputArea" class="inputArea">
                  <p class="message_reminder">Press ENTER to send your message</p>
                  <p><textarea cols="50" class="userMessage" id="userMessage${this.windowNum}"></textarea></p>
                </div>
              </div>`;case"slider":return`
              <div id="big_box${this.windowNum}" class="big_box">
              <ul id="ul${this.windowNum}">
                <li><img src="/img/slider1.png" alt=""></li>
                <li><img src="/img/slider2.png" alt=""></li>
                <li><img src="/img/slider3.png" alt=""></li>
                <li><img src="/img/slider4.png" alt=""></li>
                <li><img src="/img/slider5.png" alt=""></li>
              </ul>
              <div id="left${this.windowNum}"class="left">&lt</div>
              <div id="right${this.windowNum}" class="right">&gt</div>
              <ol id="ol${this.windowNum}">
                </ol>
              </div> `;default:return""}}}class y{constructor(e){this.windowNum=e,this.username="",this.webSocket=null}run(){document.getElementById(`close${this.windowNum}`).addEventListener("click",this.close.bind(this));const e=document.getElementById(`connectionState${this.windowNum}`),t=localStorage.getItem("cachedChat"),i=document.getElementById(`chatArea${this.windowNum}`);i.value=t,this.webSocket=new window.WebSocket("wss://courselab.lnu.se/message-app/socket"),this.webSocket.onopen=function(s){e.innerText="Connection built!"},this.webSocket.onerror=function(s){e.innerText="No Connection!"},this.webSocket.onmessage=function(s){const n=JSON.parse(s.data),d=n.username+": "+n.data;console.log("newMsg: "+d),n.type==="message"&&n.data!=""&&(i.value+=`
`+d,localStorage.setItem("cachedChat",i.value))},this.username=window.localStorage.getItem("username")===null?"":window.localStorage.getItem("username"),this.username===""?(document.getElementById(`username${this.windowNum}`).focus(),document.getElementById(`username${this.windowNum}`).addEventListener("keypress",this.addUser.bind(this))):(document.getElementById(`userMessage${this.windowNum}`).focus(),document.getElementById(`username${this.windowNum}`).style.display="none",document.getElementById(`userMessage${this.windowNum}`).addEventListener("keypress",this.pressedEnter.bind(this)))}addUser(){this.username=document.getElementById(`username${this.windowNum}`).value,window.localStorage.setItem("username",this.username),document.getElementById(`userMessage${this.windowNum}`).disabled=!1,document.getElementById(`userMessage${this.windowNum}`).focus(),document.getElementById(`userMessage${this.windowNum}`).addEventListener("keydown",this.pressedEnter.bind(this))}pressedEnter(e){e.keyCode===13&&(this.sendMessage(e.target.value),e.target.value="",e.preventDefault())}close(){const e=document.getElementById(`window${this.windowNum}`);e.parentNode.removeChild(e)}connect(){return new Promise((e,t)=>{if(this.webSocket&&this.webSocket.readyState===1){e(this.webSocket),console.log("connect first");return}this.webSocket=new window.WebSocket("wss://courselab.lnu.se/message-app/socket"),this.webSocket.onopen=()=>{e(this.webSocket),console.log("connected!")},this.webSocket.onerror=()=>t(this.webSocket),this.webSocket.onmessage=i=>{console.log("data: "+i.data),this.printMessage(JSON.parse(i.data))}})}connect(){return new Promise((e,t)=>{if(this.webSocket&&this.webSocket.readyState===1){e(this.webSocket),console.log("connect first");return}this.webSocket=new window.WebSocket("wss://courselab.lnu.se/message-app/socket"),this.webSocket.onopen=()=>{e(this.webSocket),console.log("connected!"),this.webSocket.onmessage=i=>{console.log("data: "+i.data),this.printMessage(JSON.parse(i.data))}},this.webSocket.onerror=()=>t(this.webSocket)})}sendMessage(e){const t={type:"message",data:e,username:this.username,key:"eDBE76deU7L0H9mEBgxUKVR0VCnq0XBd"};this.connect().then(function(i){i.send(JSON.stringify(t)),console.log("sent msg!")}).catch(function(i){console.log("Error: ",i)})}printMessage(e){if(e.type==="message"){const t=e.username+": "+e.data;console.log("newMsg: "+t),document.getElementById(`chatArea${this.windowNum}`).value+=`
`+t,localStorage.setItem("cachedChat",document.getElementById(`chatArea${this.windowNum}`).value)}}}class N{constructor(e){this.windowNum=e,this.attempts=0,this.matchedCard=0,this.flippedCard=[],this.faceCard=[]}run(){document.getElementById(`cards${this.windowNum}`).addEventListener("click",this.clickCard.bind(this)),document.getElementById(`cards${this.windowNum}`).addEventListener("keydown",this.keyBoard.bind(this)),document.getElementById(`grid${this.windowNum}`).addEventListener("keydown",this.keyBoard.bind(this)),document.getElementById(`close${this.windowNum}`).addEventListener("click",this.close.bind(this)),document.getElementById(`grid${this.windowNum}`).addEventListener("change",this.removeCards.bind(this)),document.getElementById(`grid${this.windowNum}`).addEventListener("change",this.generateCards.bind(this)),this.generateCards(16),this.randomizedCards()}clickCard(e){Number.isInteger(Number(e.target.id))&&this.flippedCard.length<2&&(this.cardPair[e.target.id].src=`/img/${[this.faceCard[e.target.id]]}.png`,this.flippedCard.push(e.target.id),this.flippedCard.length===2&&setTimeout(()=>{const t=this.flippedCard.pop(),i=this.flippedCard.pop();if(t!==i){this.attempts++;const s=this.faceCard[t]===this.faceCard[i];setTimeout(()=>{s?(this.cardPair[t].style.opacity=0,this.cardPair[i].style.opacity=0,this.cardPair[t].tabIndex=-1,this.cardPair[i].tabIndex=-1,this.matchedCard+=2,this.matchedCard===this.cardPair.length&&(this.removeCards(0),document.getElementById(`userMessage${this.windowNum}`).innerHTML=`Bravo! ${this.attempts} attempts in ${this.timer(-1)} seconds!`)):(this.cardPair[t].src="/img/0.png",this.cardPair[i].src="/img/0.png")},300)}else this.flippedCard.push(t)},300))}generateCards(e){for(let t=0;t<Number(e);t++){const i=document.createElement("img");i.setAttribute("src","/img/0.png"),i.setAttribute("tabindex",t===0?0:-1),i.setAttribute("id",t),i.setAttribute("class","memoDiv"),i.style.height="60px",i.style.width="60px",document.getElementById(`cards${this.windowNum}`).appendChild(i)}this.cardPair=document.getElementById(`cards${this.windowNum}`).getElementsByTagName("img");for(let t=0;t<this.cardPair.length;t++)this.cardPair[t].src="/img/0.png";this.cardPair.length>0&&this.cardPair[0].focus()}randomizedCards(){document.getElementById(`userMessage${this.windowNum}`).innerHTML="",this.attempts=0,this.matchedCard=0,this.faceCard.length=0;const e=[1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8];e.length=this.cardPair.length,this.faceCard=e.sort(()=>Math.random()-.5),this.timer(0)}removeCards(e){const t=document.getElementById(`cards${this.windowNum}`);for(;t.firstChild;)t.removeChild(t.firstChild);e!==0&&(this.generateCards(Number(e.target.value)),this.randomizedCards())}timer(e){return e===0?this.startValue=Date.now():Math.floor((Date.now()-this.startValue)/1e3)}close(){const e=document.getElementById(`window${this.windowNum}`);e.parentNode.removeChild(e)}keyBoard(e){const t=Number(document.activeElement.id);switch(e.key){case"Enter":case" ":this.clickCard(e);break;case"ArrowLeft":t!==0&&this.cardPair[t].previousElementSibling.focus();break;case"ArrowRight":t!==this.cardPair.length-1&&this.cardPair[t].nextElementSibling.focus();break;case"ArrowUp":t>3&&this.cardPair[t-4].focus();break;case"ArrowDown":t<this.cardPair.length-4&&this.cardPair[t+4].focus();break;default:document.getElementById(`grid${this.windowNum}`).focus()}}}class E{constructor(e){this.windowNum=e,this.timer=null,this.num=0}run(){document.getElementById(`close${this.windowNum}`).addEventListener("click",this.close.bind(this)),this.big_box=document.querySelector("#big_box"+this.windowNum),console.log("this.big_box: "+this.big_box+this.windowNum),this.ul=document.querySelector("#ul"+this.windowNum),console.log("this.ul: "+this.ul),this.ol=document.querySelector("#ol"+this.windowNum),console.log("this.ol: "+this.ol),this.lis_img=this.ul.querySelectorAll("li"),console.log("this.lis_img: "+this.lis_img),this.left=document.querySelector("#left"+this.windowNum),this.right=document.querySelector("#right"+this.windowNum);for(let i=0;i<this.lis_img.length;i++){const s=document.createElement("li");this.ol.appendChild(s),s.setAttribute("index",i),i===0&&(s.className="current"),s.addEventListener("click",function(){for(let d=0;d<this.ol.children.length;d++)this.ol.children[d].className="";this.className="current";const n=this.getAttribute("index");this.animate(this.ul,-n*this.big_box.offsetWidth),this.circlechange(e,n)})}const e=this.ol.querySelectorAll("li"),t=this.ul.children[0].cloneNode(!0);this.ul.appendChild(t),this.right.addEventListener("click",()=>{this.num>=this.lis_img.length&&(this.num=0,this.ul.style.left="0px"),this.num++,this.animate(this.ul,-this.num*this.big_box.offsetWidth),this.circlechange(e,this.num)}),this.left.addEventListener("click",()=>{this.num<=0&&(this.num=this.lis_img.length,this.ul.style.left=-this.lis_img.length*this.big_box.offsetWidth+"px"),this.num--,this.animate(this.ul,-this.num*this.big_box.offsetWidth),this.circlechange(e,this.num)}),this.timer=setInterval(()=>{this.right.click()},1e3),this.big_box.addEventListener("mouseover",()=>{clearInterval(this.timer)}),this.big_box.addEventListener("mouseout",()=>{clearInterval(this.timer),this.timer=setInterval(()=>{this.right.click()},1e3)})}animate(e,t){const i=setInterval(()=>{const s=e.offsetLeft;let n=20;n=s>t?-n:n,Math.abs(s-t)<=Math.abs(n)?(clearInterval(i),e.style.left=t+"px"):e.style.left=s+n+"px"},20)}circlechange(e,t){t===this.lis_img.length&&(t=0);for(let i=0;i<e.length;i++)e[i].className="";e[t].className="current"}close(){const e=document.getElementById(`window${this.windowNum}`);e.parentNode.removeChild(e)}}let g,a=0,r=null,h=0,c=0,l=0,m=0,w=0,p=0,f=0;function v(){g=document.getElementById("container"),document.querySelector("#memo").addEventListener("click",u),document.querySelector("#chat").addEventListener("click",u),document.querySelector("#slider").addEventListener("click",u)}window.addEventListener("load",v);function u(o){c+=40,l+=40,l>=500&&(l=1.5*c,c=20),h++,a++;let e;const t=new b(a,String(o.target.id),h,c,l).generateWindow();switch(g.appendChild(t),t.addEventListener("drag",k(t)),console.log("event.target.id: "+o.target.id),o.target.id){case"chat":e=new y(a);break;case"memo":e=new N(a);break;case"slider":e=new E(a);break}e.run()}function k(o){o.onmousedown=function(){return S(this),!1},document.onmousemove=C,document.onmouseup=I}function S(o){r=o,p=m-r.offsetLeft,f=w-r.offsetTop,h++,o.style.zIndex=h}function C(o){m=document.all?window.event.clientX:o.pageX,w=document.all?window.event.clientY:o.pageY,r!==null&&(r.style.left=m-p+"px",r.style.top=w-f+"px")}function I(){r=null}
